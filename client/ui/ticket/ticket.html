<!-- TICKET_PAGE -->
<template name="ticket_page">
	<article>
		<div class="card my-2">
			<div class="card-body">
				<div class="text-center">
					<h2 class="card-title">{{ticket.title}}</h2>
					
					<h6 class="card-subtitle text-muted mb-2">Publié le {{getDisplayDateTime ticket.createdAt}} par <a href="/profil/{{ticket.ownerId}}">{{getUserFullname  ticket.ownerId}}</a></h6>
					<p class="small">Modifié {{ticket.counterEdit}} fois</p>
					
					{{#if equals ticket.ownerId currentUser._id}}
					<a href="/ticket/{{ticket._id}}/edit" class="btn btn-primary btn-sm mb-3">Modifier</a>
					
					<button class="btn btn-danger btn-sm mb-3 js-delete-ticket">Supprimer</button>
					{{/if}}
					<p class="card-text text-justify" style="white-space: pre-line">
						{{ticket.content}}
					</p>
				</div>
			</div>
		</div>
		{{> correction_form}}
		{{> correction_proposition}}
		{{> correction_accepted_list}}
	</article>
</template>

<!-- TICKET_PROPOSITION -->
<template name="ticket_proposition">
	<article class="card my-2">
		<button type="submit" class="btn-proposition-ticket btn btn-outline-info">Ouvrir un ticket pour corriger du texte</button>
	</article>
</template>

<!-- TICKET_CREATE_FORM -->
<template name="ticket_create_form">
	<article class="card my-2">
		<h5 class="card-header">Formulaire de création d'un ticket</h5>
		
		<div class="card-body">
		
		<form class="create-ticket js-create-ticket">
			
			<input class="form-control" type="text" placeholder="Titre du contenu à corriger" name="title">
			<textarea class="form-control mb-2" name="content" rows="20" placeholder="Texte à corriger"></textarea>
			
			<div class="my-1">
				<button type="button" class="btn-cancel btn btn-light">Annuler</button>
				<button type="submit" class="btn-create-ticket btn btn-success">Envoyer le ticket</button>
			</div>
		</form>
		</div>
	</article>
</template>

<!-- TICKET_EDIT_FORM -->
<template name="ticket_edit_form">
	<article class="card my-2">
		<h5 class="card-header">Modifier un ticket</h5>
		
		<div class="card-body">
		
		<form class="edit-ticket js-edit-ticket">
			
			<input class="form-control mb-2" type="text" placeholder="Titre du contenu à corriger" name="title" value="{{ticket.title}}">
			<textarea class="form-control mb-2" name="content" rows="20" placeholder="Texte à corriger">{{ticket.content}}</textarea>
			
			<div class="my-1">
				<a href="/ticket/{{ticket._id}}" class="btn-cancel btn btn-light">Annuler</a>
				<button type="submit" class="js-edit-ticket btn btn-success">Modifier le ticket</button>
			</div>
		</form>
		</div>
	</article>
</template>

<!-- TICKET_LIST -->
<template name="ticket_list">
	<article>
		<h3 class="py-4"><i class="fa fa-ticket" aria-hidden="true"></i> Derniers tickets</h3>
		{{#each ticket in tickets}}
			{{> ticket_single ticket}}
		{{else}}
		<h4>Aucun élément à afficher</h4>
		{{/each}}
	</article>
</template>

<!-- TICKET_SINGLE -->
<template name="ticket_single" >
	<div class="row ticket-single">
		<div class="card-body col-sm-7 col-lg-8">
			<h4 class="card-title">{{this.title}}</h4>
			<p class="card-text-date">Publié le {{getDisplayDateTime this.createdAt}}</p>
			<p class="card-text-author">par <a href="/profil/{{this.ownerId}}">{{getUserFullname this.ownerId}}</a></p>
			
		</div>
		<aside class="card-body col-sm-5 col-lg-4 d-flex flex-column justify-content-around ">
			<a href="/ticket/{{this._id}}" class="btn btn-primary btn-sm ">Afficher le ticket</a>
			<div class="contributors  mx-auto">
				<span class="small">{{> contributeurs}}</span>
			</div>
			
		</aside>
	</div>
</template>

<template name="contributeurs">
{{contributeurs this._id}} contribution{{superieur (contributeurs this._id)}}

</template>